<ul class="{{ ulClass }}" id="{{ ulId }}">

    {% for page in container %}

        {% if navigation.isAllowed(page) %}

            {% set liClass = '' %}
            {% set extraAttributes = '' %}
            {% if navigation.isActive(page) %}
                {% set liClass = 'active' %}
            {% endif %}

            {% if page.hasChildren() %}
                {% set liClass = liClass ~ ' parent' %}
            {% endif %}

            {% if page.getOption('type') and page.getOption('type') == 'separator' %}
                <li role="presentation" class="divider"></li>
            {% else %}
                <li class="{{ liClass }}">
                    <a href="{{ navigation.getHref(page) }}" {% autoescape false %}{{ navigationPageAttributes(page) ~ extraAttributes }}{% endautoescape %} >
                        {% if page.hasChildren() and depth == 0 %}
                            <div data-toggle="collapse" href="#sub-item-{{ loop.index }}">
                                <i class="{{ page.getOption('icon') }}"></i>&nbsp;
                                {{ page.getOption('label') }}
                                <i class="fa fa-chevron-circle-down pull-right"></i>
                            </div>
                        {% else %}
                            {% if page.getOption('icon') %}

                                <i class="{{ page.getOption('icon') }}"></i>

                            {% endif %}

                            {{ page.getOption('label') }}
                        {% endif %}
                    </a>

                    {% if page.hasChildren() %}
                        {% set subitemUlClass = 'children collapse' %}
                        {% if navigation.isActive(page) %}
                            {% set subitemUlClass = subitemUlClass ~ ' in' %}
                        {% endif %}

                        {% set ulId = 'sub-item-' ~ loop.index %}
                        {{ navigationPartial(page, 'partial::menu', {'ulClass' : subitemUlClass, 'ulId': ulId, 'depth' : depth + 1}) }}

                    {% endif %}

                </li>
            {% endif %}

        {% endif %}

    {% endfor %}
</ul>
